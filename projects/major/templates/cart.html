{% load static %}

<html>
	<head>
		<title>CODERS HUB</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<link rel="stylesheet" href="{% static 'assets/css/font-awesome.min.css' %}">
        <link rel="stylesheet" href="{% static 'assets/css/new1.css/' %}">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <style>
			html{
				scroll-behavior: smooth;
			}
            .regnavbar{
                list-style-type: none;
                margin: 0;
                padding: 0;
                overflow: hidden;
                background-color: #333;
                position: -webkit-sticky; /* Safari */
                position: sticky;
                top: 0;		
            }

            .regnavbar li{
                float: left;
            }
            .regnavbar li a {
                display: block;
                color: white;
                text-align: center;
                padding: 14px 16px;
                text-decoration: none;
              }
              
             .regnavbar li a:hover {
                background-color: #111;
              }
              .active {
                background-color: #026980;
			  }
			  .navtpc{
				  background-color: #333;
			  }
			  table th,td,thead,tr{
                  text-align: center;
                  vertical-align: middle;
                  padding: 0.75rem 3.75rem;
              }
              
        </style>    
	</head>

	<body class="is-preload" >

		<!-- Header -->
			<header id="header" style="position:absolute">
				<a class="logo" href="index.html">CODERS HUB</a>
				<nav>
                    {% if user.is_authenticated %}
					<i class="fa fa-user" style="font-size:24px;text-align:center;display:inline-block" aria-hidden="true" ></i>
					<button style="background-color:transparent;color:#ff192a;padding-left:5px;padding:1px 0.55rem;display:inline-block" >{{user.first_name}}</button>
					<!--<div id="hidlogout" style="background-color:transparent;color:#ff192a;padding-right:13px;display:inline-block"><a="logout" style="text-decoration:none;color:#ff1818cc">LogOut</a></div>-->
					<button style="background-color:transparent;color:#ff192a;padding-right:11px;display:inline-block;padding: 0px 0.8rem;" onclick="location.href='logout'">LogOut</button>
					{% else %}
					<button style="background-color:transparent;color:#a51313;" onclick="toggle_visibility()">SignIn/Register</button>			
					{% endif %}

                    <a href="#menu" style="display:inline-block">Menu</a>
                </nav>  
            </header>
            <div class="form-popup" id="myForm">
				<form action="login" class="form-container" method="POST">
					{% csrf_token %}
				  <h1 style="color:#ffffff">Login</h1>
			  
				  <label for="email"><b style="color:white">Username</b><div id="error_msg1" style="font-size: 10px;display:none;color:red">&nbsp;&nbsp;&nbsp;&nbsp; *Enter Valid Username</div></label>
				  
				  <input type="text" id="email_login" placeholder="Enter Username" name="uname" onchange="validateLogin()" required>
				
				  <label for="psw" ><b style="color:white">Password</b> <div id="error_msg2" style="font-size: 10px; display: none;color:red">*Password must be between 8 to 15 characters with at least one lowercase letter, one uppercase letter, one numeric digit, and one special character</div></label>
				  <input type="password" id="pwd_login" placeholder="Enter Password" name="psw" onchange="validateLogin()" required>
				 
				  <button type="submit" class="btn">Login</button>
				  <button type="button"  class="btn cancel" onclick="openRegisterForm()" >New user</button>
				  <p style="text-align:center">Forgot Password?</p>
				</form>
			  </div>
			  <div class="form-popup" id="myForm2" style="height: 707px;">
                <form action="register" method="POST" class="form-container">
					{% csrf_token %}
				  <h1 style="color:#ffffff">Register</h1>
			  
				  <label for="fname" ><b style="color:white">First Name</b></label>
				  <input type="text" placeholder="Enter Full Name" name="fname" required>
				  <label for="fname" ><b style="color:white">Last Name</b></label>
				  <input type="text" placeholder="Enter Full Name" name="lname" required>
				  <label for="lname" ><b style="color:white">Username</b></label>
				  <input type="text" placeholder="Enter Username" name="username" required>

				  <label for="email" ><b style="color:white">Email-Id</b></label>
				  <input type="text" placeholder="Enter Email" name="email" required>
		
				  <label for="psw" ><b style="color:white">New Password</b></label>
				  <input type="password" placeholder="Enter Password" name="psw" required>
				  <label for="psw" ><b style="color:white">Confirm Password</b></label>
				  <input type="password" placeholder="Retype Password" name="rpsw" required>
				  <button type="submit"  class="btn cancel"  style="width:100%" onsubmit="return validateRegister()">Register Now!</button>
				</form>
            </div>
            <nav id="menu">
				<ul class="links">
					<li><a href="home">Home</a></li>
					<li><a href="elements.html">Elements</a></li>
					<li><a href="about">About Us</a></li>
				</ul>
            </nav>  
            <!-- <p>{{img}}</p> -->
          <!-- {% for i in items %}
            <p>{{i}}</p>
            <p>{{i.productname_id}}</p>
            <p>{{i.productname}}</p>
            <p>{{i.productname.productprice}}</p>
            <p>{{i.productname.productimage}}</p>
            <p>{{i.quantity}}</p>
            
          {% endfor %} -->
            {% if flag == '1' %}

                <h1 style="text-align:center;">KINDLY LOGIN FIRST</h1>
                {% else %}
                   <div style="box-shadow:0px 0px 10px gray;width:70%;margin-left:13%;margin-top:10%;">  
                    <table class="table cart">
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Product</th>
                                <!-- <th>Quantity</th> -->
                                <th>Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                            {% for i in items %}
                            <tr>
                                <td><img src="/media/{{i.productname.productimage}}" style="height:90px;width:70px"></td>
                                <td>{{i.productname}}</td>
                                <!-- <td style="padding: 0.75rem 0.75rem;"> -->
                                <div class="row" style="display:grid;grid-template-columns:0.1fr 0.3fr 0.1fr;grid-gap:0px;margin-left: 24px;margin-top: 11px;">
                                    <!-- <div class="col">
                                        <i class="fa fa-plus bg" onclick="change_quan('{{i.productname_id}}','plus','{{i.productname.productprice}}')" style="margin-top:60%;cursor:pointer"></i>
                                    </div> -->
                                    <!-- <div class="col">
                                        <form action="{% url 'changequan' %}">
                                            <input type="number" value="{{i.quantity}}" class="form-control" id="cart{{i.productname_id}}" name="quantityval" style="width:30px;background-color:white;outline:none" readonly><br>
                                            <input type="hidden" value="{{i.productname_id}}" name="pid">
                                            <button type="submit" style="background-color: #30683f;border-radius:5px;color:white;line-height: 0rem;height:20px;padding:10px;font-weight:10;margin-top: 11px;">Update Quantity</button>
                                        </form>
                                    </div> -->
                                    <!-- <div class="col">
                                        <i class="fa fa-minus bg" onclick="change_quan('{{i.productname_id}}','minus','{{i.productname.productprice}}')" style="margin-top:60%;cursor:pointer"></i>
                                    </div> -->
                                </div>
                                </td>
                                <td id="item{{i.productname_id}}">&#8377;{{i.productname.productprice}}</td> 
                                <form action="{% url 'removecartitem' %}" method="get"> 
                                    <input type="hidden" value="{{i.productname_id}}" name="pnameid">
                                <td id="{{i.productname_id}}"><i class="far fa-trash-alt"></i><button type=submit>Remove</button></td>
                                </form>
                            </tr>
                            {% endfor %}

                            <tr><td>CART TOTAL</td><td></td>
                                <!-- <td id=qty{{i.productname_id}}>{{qtysum}}</td> -->
                                <td id=totalcart>&#8377;{{pricesum}}</td>
                         </tr>

                         </tbody>
                         
                    </table>
                    </div>
                    <div style="margin-left:67%">
                    <button type="submit" style="background-color: green;border-radius:5px;color:white;">Buy Now</button>
                    <button type="submit" style="background-color: red;border-radius:5px;color:white;">Delete cart</button>

                    </div>
                </form>
                   
             {% endif %}       
                                
            <!-- <table id="cartitems">
                <th>Product Image</th>
                <th>Product</th>
                <th>Price</th>
                <th>Quantity</th>                
                <th>Item Total</th>
                {% for i in items}
                <tr>
                    <td><img src="/media/{{i.product.product_image}}" >
            </table>     -->

           


            <script src="{% static 'assets/js/jquery.min.js' %}"></script>
            <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD-_RHlOhsIBOTU20mJc8OvTC3ZF_nsb_o&callback=initMap"></script>
			<script>
				$(document).ready(function(){
					$(".regnavbar li").click(function(){
						$("li").removeClass("active");
						$(this).addClass("active");
					});

				});
    

				function toggle_visibility()
				 {
					var e = document.getElementById("myForm");
					var e1 = document.getElementById("myForm2");
					if(e.style.display == 'block' || e1.style.display=="block" )
					{
						e.style.display = 'none';
						e1.style.display='none';
					}		
					else
						e.style.display = 'block';
				}
				function toggle_visibility_login()
				 {
					var f = document.getElementById("hidlogout");
					if(f.style.display == 'block')
					{
						f.style.display = 'none';
					}		
					else
						f.style.display = 'block';
				}

				function validateLogin()
				{

					var input_email=document.getElementById("email_login").value;
					if (input_email.substring(input_email.length-4,input_email.length)!=".com" && input_email.length!=0 || input_email.indexOf("@")<1 && input_email.length!=0  )
					{
					   document.getElementById("error_msg1").style.display="inline-block";
					}
					else
					document.getElementById("error_msg1").style.display="none";

					var input_pwd=document.getElementById("pwd_login").value;
				    var reg=  /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{8,15}$/;
					if(	input_pwd.match(reg)==null && input_pwd.length!=0) 
						{ 
							document.getElementById("error_msg2").style.display="inline-block";
							document.getElementById("myForm").style.height="407px";
							
						}
					else{
						
					document.getElementById("error_msg2").style.display="none";
					document.getElementById("myForm").style.height="362px";
					}
					
				}

				function openRegisterForm()
				 {
					document.getElementById("myForm").style.display = "none";
					document.getElementById("myForm2").style.display = "block";
                }


                function change_quan(id,action,price){
                    let old = $("#cart"+id).val();
                    let oldqty= $("#qty"+id).val();
                    let cntadd=0;
                    let cntsub=0;
                    console.log("hi");
                    quan = 0
                    if(action=="plus"){
                        quan += parseInt(old)+1
                        cntadd+=1
                        console.log(price)
                        
                    }else{
                        quan += parseInt(old)-1
                        cntsub+=1
                    }
                    $("#item"+id).val(quan*parseInt(price));
                    var idno="item"+id;
                    console.log(idno);
                    document.getElementById(idno).innerHTML= (quan)*(parseInt(price));
                    var qtyid="qty"+id;
                   

                    console.log("#item"+id,quan*parseInt(price))
                    $("#cart"+id).val(quan);
                }
                    
         
         
                  
            </script>
            <script type="text/javascript">
				/* NOTE : Use web server to view HTML files as real-time update will not work if you directly open the HTML file in the browser. */
				(function(d, m){
				  var kommunicateSettings = {"appId":"19fa8e755b60b29c0a9c5e7775b105068","popupWidget":true,"automaticChatOpenOnNavigation":true};
				  var s = document.createElement("script"); s.type = "text/javascript"; s.async = true;
				  s.src = "https://widget.kommunicate.io/v2/kommunicate.app";
				  var h = document.getElementsByTagName("head")[0]; h.appendChild(s);
				  window.kommunicate = m; m._globals = kommunicateSettings;
				})(document, window.kommunicate || {});
			</script>
			<script src="{% static 'https://kit.fontawesome.com/b764a53ebc.js' %}" ></script>
			<script src="{% static 'assets/js/browser.min.js' %}"></script>
			<script src="{% static 'assets/js/breakpoints.min.js' %}"></script>
			<script src="{% static 'assets/js/util.js' %}"></script>
            <script src="{% static 'assets/js/main.js' %}"></script>
    </body>
</html>    